"""Journal style configuration for scientific publications."""

from dataclasses import dataclass, field
from enum import Enum


class FigureWidth(Enum):
    """Standard figure widths in inches for scientific journals."""

    SINGLE_COLUMN = 3.54  # 90 mm
    ONE_HALF_COLUMN = 5.51  # 140 mm
    DOUBLE_COLUMN = 7.48  # 190 mm


class ImageType(Enum):
    """Image type with corresponding DPI requirements."""

    LINE_ART = 300
    COMBINATION = 300
    HALFTONE = 300


@dataclass
class JournalStyle:
    """Scientific journal style configuration for visualization."""

    # Font settings
    font_family: str = 'DejaVu Sans'
    font_size: float = 8.0
    font_size_small: float = 7.0
    font_size_title: float = 9.0

    # Line settings
    line_width: float = 0.8
    line_width_thick: float = 1.2
    axis_line_width: float = 0.5
    tick_major_width: float = 0.5
    tick_minor_width: float = 0.3

    # Marker settings
    marker_size: float = 4.0
    marker_size_small: float = 3.0

    # Color-blind friendly palette (Wong)
    colors: tuple[str, ...] = field(
        default_factory=lambda: (
            '#0072B2',  # Blue
            '#D55E00',  # Vermilion
            '#009E73',  # Green
            '#CC79A7',  # Pink
            '#F0E442',  # Yellow
            '#56B4E9',  # Sky Blue
            '#E69F00',  # Orange
        )
    )

    # Algorithm-specific colors for consistency
    algorithm_colors: dict[str, str] = field(
        default_factory=lambda: {
            'GA': '#0072B2',  # Blue for Genetic Algorithm
            'SA': '#D55E00',  # Vermilion for Simulated Annealing
            'RL': '#009E73',  # Green for Reinforcement Learning
            'Random': '#999999',  # Gray for Random baseline
        }
    )

    # Default output settings
    default_width: float = 3.54
    default_dpi: int = 1000
    default_format: str = 'png'

    def get_rc_params(self) -> dict:
        """Return matplotlib/ultraplot rc parameters."""
        return {
            'font.family': self.font_family,
            'font.size': self.font_size,
            'axes.linewidth': self.axis_line_width,
            'axes.labelsize': self.font_size,
            'axes.titlesize': self.font_size_title,
            'xtick.labelsize': self.font_size,
            'ytick.labelsize': self.font_size,
            'xtick.major.width': self.tick_major_width,
            'ytick.major.width': self.tick_major_width,
            'xtick.minor.width': self.tick_minor_width,
            'ytick.minor.width': self.tick_minor_width,
            'lines.linewidth': self.line_width,
            'lines.markersize': self.marker_size,
            'legend.fontsize': self.font_size_small,
            'legend.frameon': False,
            'savefig.dpi': self.default_dpi,
            'savefig.bbox': 'tight',
            'savefig.pad_inches': 0.02,
        }

    def get_color(self, index: int) -> str:
        """Return color at given index with cycling."""
        return self.colors[index % len(self.colors)]

    def get_algorithm_color(self, algorithm: str) -> str:
        """Return consistent color for an algorithm."""
        return self.algorithm_colors.get(algorithm, self.get_color(0))


JOURNAL_STYLE = JournalStyle()
